<div data-role="view" data-title="Calendar" data-layout="main" data-model="app.models.calView">

	<div id="calendar"></div>

	<script>

	$(document).ready(function() { 

		var calendar = $('#calendar').fullCalendar({
			aspectRatio: 1, 
			header: {
				left: 'today prev,next', 
				center: 'title', 
				right: 'month,agendaWeek,agendaDay'
			},

			dayClick: function(date, jsEvent, view) { 
				calendar.fullCalendar('changeView', 'agendaDay');
				calendar.fullCalendar('gotoDate', date);
			}

		});


		var allDayBoolean = false;


		// ----read in data from Food database-----
		var el = new Everlive('TiQ179pLOVoq4iN1');
		var foodData = el.data('Food');
		foodData.get()
		.then(function(foodData){
			//alert(JSON.stringify(data));
			// console.log(foodData.count);
			// console.log(foodData.result);
			var foodTitle = "";
			var foodStartTime = "";
			var foodEndTime = "";

			var allFoodEvents =	{
				    events: [],
				    color: 'red',   // an option!
				    textColor: 'black' // an option!
				}

			for (var i = 0; i < foodData.count; i++) { 
				// console.log(i);
				foodTitle = "Food: " + foodData.result[i].food_name;
				foodStartTime = foodData.result[i].time;
				foodEndTime = new Date(foodStartTime.getTime() + 15*60000);
				// console.log(foodStartTime);
				// console.log(foodEndTime);
				// console.log(foodTitle);

				var foodEvent = {
					title: foodTitle,
					allDay: allDayBoolean,
					start: foodStartTime,
					end: foodEndTime,
				}

				 allFoodEvents.events.push(foodEvent);

		    } // close loop
		    calendar.fullCalendar('addEventSource', allFoodEvents);
			//console.log(foodData);
		},
		function(error){
			alert(JSON.stringify(error));
		});


		// ----read in data from Medication database-----
		var medData = el.data('Medication');
		medData.get()
		.then(function(medData){
			//alert(JSON.stringify(data));
			// console.log(actData.count);
			// console.log(actData.result);
			var medTitle = "";
			var medStartTime = "";
			var medEndTime = "";

			var allMedEvents =	{
				    events: [],
				    color: 'orange',   // an option!
				    textColor: 'black' // an option!
				}

			for (var i = 0; i < medData.count; i++) { 
				// console.log(i);
				medTitle = "MED: " + medData.result[i].name_of_med;
				medStartTime = medData.result[i].time;
				medEndTime = new Date(medStartTime.getTime() + 15*60000);
				// console.log(medStartTime);
				// console.log(medEndTime);
				// console.log(medTitle);

				var medEvent = {
					title: medTitle,
					allDay: allDayBoolean,
					start: medStartTime,
					end: medEndTime,
				}

				 allMedEvents.events.push(medEvent);

		    } // close loop
		    calendar.fullCalendar('addEventSource', allMedEvents);
			//console.log(medData);
		},
		function(error){
			alert(JSON.stringify(error));
		});

		// ----read in data from Activity database-----
		var actData = el.data('act');
		actData.get()
		.then(function(actData){
			//alert(JSON.stringify(data));
			console.log(actData.count);
			console.log(actData.result);
			var actTitle = "";
			var actStartTime = "";
			var actEndTime = "";

			var allActEvents =	{
				    events: [],
				    color: 'purple',   // an option!
				    textColor: 'black' // an option!
				}

			for (var i = 0; i < actData.count; i++) { 
				console.log(i);
				actTitle = "ACT: " + actData.result[i].activity;
				actStartTime = actData.result[i].start_time;
				actEndTime = actData.result[i].end_time;
				console.log(actStartTime);
				console.log(actEndTime);
				console.log(actTitle);

				var actEvent = {
					title: actTitle,
					allDay: allDayBoolean,
					start: actStartTime,
					end: actEndTime,
				}

				 allActEvents.events.push(actEvent);

		     } // close loop
		     calendar.fullCalendar('addEventSource', allActEvents);
			console.log(medData);
		},
		function(error){
			alert(JSON.stringify(error));
		});




	});
	
	</script>

</div>
